<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>찬란</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet" />
        <link rel="stylesheet" href="index.css" />
    </head>
    <body>
        <style>
            /* 커서 스타일 */
            body {
                cursor: url('./svg/starpoint.svg'), auto;
            }
        </style>

        <div class="page-transition-wrapper" id="pageWrapper">
            <!-- 중앙에 이미지 배치 -->
            <div class="image-container">
                <!-- 클릭할 수 있는 영역을 추가하되, 이미지 크기와 위치에 영향을 주지 않도록 설정 -->
                <a href="mean.html" class="image-link">
                    <img id="bluestarImage" src="./png/bluestar_static.png" alt="Bluestar" class="centered-image" />
                </a>
            </div>

            <!-- 화면 하단 중앙 버튼 이미지 -->
            <div class="button-container">
                <a href="poem.html" id="goToPoemLink">
                    <img src="./svg/below_button.svg" alt="Go to Poem" />
                </a>
            </div>

            <!-- 타이핑 효과 텍스트 -->
            <div class="typing-container"><span id="text1" class="text1"></span><span id="cursor"></span></div>
        </div>

        <script>
            const image = document.getElementById('bluestarImage');
            const apngSrc = './png/bluestar_a.png';
            const staticSrc = './png/bluestar_static.png';

            // APNG 애니메이션이 끝날 때까지 기다리기 위한 대기 시간 (애니메이션의 길이에 맞게 설정)
            const apngDuration = 1800; // 예: 4초 정도로 설정 (실제 APNG의 애니메이션 길이에 맞게 조정)

            // 마우스가 이미지 위에 올라갔을 때
            image.addEventListener('mouseenter', () => {
                image.src = apngSrc; // APNG 이미지로 변경
            });

            // 마우스가 이미지에서 벗어났을 때
            image.addEventListener('mouseleave', () => {
                // APNG 애니메이션이 끝날 때까지 대기 후 정적 이미지로 변경
                setTimeout(() => {
                    image.src = staticSrc; // 정적 이미지로 변경
                }, apngDuration); // 애니메이션이 끝날 때까지 대기
            });

            const text1 = '찬  란';
            const text2 = '燦  爛';
            const text3 = 'brilliant';
            let index = 0;
            let speed = 700;
            let deleteSpeed = 500;
            let deleteIndex = text1.length;

            function typeWriter() {
                const textElement = document.getElementById('text1');
                textElement.classList.add('text1');
                if (index < text1.length) {
                    textElement.textContent += text1.charAt(index);
                    index++;
                    setTimeout(typeWriter, speed);
                } else {
                    setTimeout(deleteText1, 4000);
                }
            }

            function deleteText1() {
                const textElement = document.getElementById('text1');
                if (deleteIndex > 0) {
                    textElement.textContent = text1.substring(0, deleteIndex - 1);
                    deleteIndex--;
                    setTimeout(deleteText1, deleteSpeed);
                } else {
                    setTimeout(() => {
                        index = 0;
                        deleteIndex = text2.length;
                        typeWriter2();
                    }, 500);
                }
            }

            function typeWriter2() {
                const textElement = document.getElementById('text1');
                textElement.classList.remove('text1');
                textElement.classList.add('text2');
                if (index < text2.length) {
                    textElement.textContent += text2.charAt(index);
                    index++;
                    setTimeout(typeWriter2, speed);
                } else {
                    setTimeout(deleteText2, 4000);
                }
            }

            function deleteText2() {
                const textElement = document.getElementById('text1');
                if (deleteIndex > 0) {
                    textElement.textContent = text2.substring(0, deleteIndex - 1);
                    deleteIndex--;
                    setTimeout(deleteText2, deleteSpeed);
                } else {
                    setTimeout(() => {
                        index = 0;
                        deleteIndex = text3.length;
                        typeWriter3();
                    }, 500);
                }
            }

            function typeWriter3() {
                const textElement = document.getElementById('text1');
                textElement.classList.remove('text2');
                textElement.classList.add('text3');
                if (index < text3.length) {
                    textElement.textContent += text3.charAt(index);
                    index++;
                    setTimeout(typeWriter3, speed);
                } else {
                    setTimeout(deleteText3, 4000);
                }
            }

            function deleteText3() {
                const textElement = document.getElementById('text1');
                if (deleteIndex > 0) {
                    textElement.textContent = text3.substring(0, deleteIndex - 1);
                    deleteIndex--;
                    setTimeout(deleteText3, deleteSpeed);
                } else {
                    setTimeout(() => {
                        index = 0;
                        deleteIndex = text1.length;
                        typeWriter();
                    }, 500);
                }
            }

            typeWriter();

            const pageWrapper = document.getElementById('pageWrapper');
            const goToPoemLink = document.getElementById('goToPoemLink');

            goToPoemLink.addEventListener('click', (event) => {
                event.preventDefault();
                pageWrapper.classList.add('page-transition');
                setTimeout(() => {
                    window.location.href = goToPoemLink.href;
                }, 500);
            });
        </script>

        <style>
            html,
            body {
                height: 100%;
                margin: 0;
                font-size: 120px;
                line-height: 3;
                overflow: hidden;
                display: flex;
                justify-content: center;
                align-items: center;
                background-color: #fffef3;
                background-image: url('./textures/Noise & Texture.svg');
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat;
            }

            .typing-container {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 20vw;
                text-align: center;
                color: #010101;
                z-index: 0;
            }

            .text1 {
                font-family: 'Noto Serif KR', serif;
            }
            .text2 {
                font-family: 'Noto Sans KR', sans-serif;
            }
            .text3 {
                font-family: 'Noto Serif KR', sans-serif;
            }

            #cursor {
                display: inline-block;
                width: 0.5vw;
                height: 20vw;
                background-color: #2c55ff;
                margin-left: 5px;
                animation: blink 1s step-end infinite;
            }

            @keyframes blink {
                50% {
                    opacity: 0;
                }
            }

            .image-container {
                position: absolute;
                top: 0%;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1;
            }

            .centered-image {
                display: block;
                width: 30vw;
                height: auto;
                object-fit: contain;
            }

            .button-container {
                position: fixed;
                bottom: 1%;
                left: 50%;
                transform: translateX(-50%);
                z-index: 100;
            }

            .button-container img {
                width: 3.5vw;
                height: auto;
                transition: transform 0.3s ease;
            }

            .button-container img:hover {
                transform: scale(1.2);
            }

            .page-transition-wrapper {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                transition: transform 0.5s ease;
            }

            .page-transition {
                transform: translateY(-100%);
            }
        </style>
    </body>
</html>
